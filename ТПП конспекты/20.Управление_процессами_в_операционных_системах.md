# Управление процессами в операционных системах

Основные задачи, решаемые системой управления процессами:
- создание и завершение жизненного цикла процесса
- менеджмент ресурсов: память и доступ к устройствам
- распределение процессов по времени
- оргиназация взаимодействия между процессами

## Жизненный цикл процесса

>создание процесса

при создании процесса создются 2 основные структуры:
* контекст
* дескриптор
    
В контекст входит внутреннее состояние процесса, также содержится информация о прерывании, которая нужна для последующего запуска. Также контекст содержит информацию об открытых процессом файлов.

Дескриптор содержит ID, статус процесса, уровень его привелигированности.

Процессы могут быть созданы:
- при инициализации системы
- системным вызовом другим процессом
- запрос пользователя на создание процесса (например через UI)

В unix системах существует только один вызов для создания копиии процесса - fork. После создания процесс обычно запускает новую программу.

>завершение процесса

4 варианта завершения процесса:
* обычный выход, добровольно
* завершение при возникновении ошибки, также добровольно
* выход при фатальной ошибке (принудительно)
* принудительное завершение другим процессом

Обычный выход подразумевает добровольное завершение программы, логический конец ее работы.
Возникновение ошибки подразумевает обработку этой ошибки, и дальнейшее завершение процесса. В случае фатальной ошибки – произошло что-то непредсказуемое и требуется завершить работу принудительно. 
Другой процесс может завершить процесс если есть соответствующие права, в unix это делается вызовом kill <ID процесса>

## Расрпеделение процессов по времени, алгоритмы
Часть ОС занимающаяся выбором следующего процесса для исполнения называется планировщиком.
Алгоримы планирования могут основываться на:
* квантовании по времени
* приоритетах

При квантовании по времени кадлому процессу выделяется определенное количество времени, по истечении которого планировщик ставит другой процесс. Для разных процессов кванты могут быть разными по длительности.
Переключение процессов – дорогостоющая операция и планировщик должен делать ее эффективно.

Алгоритмы основанные на приоритете подразумевают выставление процессам числа обозначающего как много времени он будет проводить в очереди. Чем выше приоритет тем соответвтенно меньше процесс ждет своей очереди.

Не вытесняющая многозадачность – процесс выполняется пока не завершиться или самостоятельно не отдаст управление другому процессу. 
Вытесняющая многозадачность – все решает планировщик, кто и сколько будет исполняться.

В целом, каждый алгоритм разделения процессов по времени должен справедливо предоставлять каждому процессу время. Должна соблюдаться выбранная политика. Для различных типов систем будут боле эффективны разные подходы. 
Для систем реального времени требуется гарантированная отработка за строго заданный промежуток времени, максимальная предсказуемость. Для интерактивных систем важно время отклика и плавность работы системы.

Один из простейших алгоритмов организации – первым пришел, первым будешь обслужен.

<!-- доп. очередь для процессов, которые много читали, тип они обделены по времени -->

<!-- можно привести пример с round-robin, но это относится к вычислительным сетям или управлению потоками. Есть N исполнителей и M задач. в цикле по исполнителем каждому назначается своя задача, может дополнительно осуществляться квантование по времени. -->

## Межпроцессорное взаимодействие, синхронизация
<!-- гонка, семафор, барьер, философы-->
Классическим примером описания задачи синхронизации ресурсов является задача о 5 философах. 
Каждый философ чередует прием пищи и размышления. За столом перед каждым философом находится тарелка с спагетти. Стол круглый, все тарелки расставлены по кругу. Между каждыми двумя тарелками лежит вилка. Задача стоит в том, чтобы организовать философов так, чтобы никто из них не зависал т.е. не происходило блокировок.
Одна из простейших возможностей решить эту задачу – внести степень случайности. Если после каждой неудачной попытки взять вилку философ будет ждать произвольное количество времени а затем делать попытку взять вилку с случайной стороны то время ожидания заметно снизится. Подобное решение применяется в сетях передачи данных, например Ethernet, где после неудачной попытке начать передачу пакета происходит ожидание случайно длительности.

Примитивный способ синхронизации – семафор. Представляет числовую переменную, которую можно увеличивать или уменьшать. Двоичный семафор может принимать только значение 0 или 1. Критической секцией кода называется участок кода, внутри которого используется общий ресурс. Двоичный семафор может использоваться для организации исполнения критических участков кода.

&nbsp;
<hr>

> [Список вопросов](Вопросы_ТПП.md)