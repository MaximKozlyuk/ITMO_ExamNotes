# Программная модель процессора Intelx86

Программная модель микропроцессора представляет собой проrраммно-доступную часть ero внутренней архитектуры. В нее входят программно-доступные регистры, которые могут быть использованы в качестве операндов программ.

Программная модель процессора Intel 80386 представляет собой 16 32-разрядных регистров. Они делятся на следующие категории:

* регистры общего назначения;
* специализированные регистры
    * сегментные регистры;
    * регистр флагов;
    * регистр указателя инструкции.

## Регистры общего назначения

Регистры общего назначения (РОН) используются для пересылки данных и выполнения арифметических операций.

Функциональное назначение регистров:

* EAX (регистр-аккумулятор) используется в командах умножения и деления;
* EBX (базовый регистр) может использоваться в качестве указателя;
* ECX (регистр-счетчик) используется как счетчик цикла (команда LOOP);
* EDX (регистр данных) используется для хранения старших разрядов результата выполнения команд деления и умножения;

* ESP (указатель стека) указывает на адрес вершины стека;
* EBP (указатель базы) может содержать базовый адрес операнда в памяти. обычно используется языками высокого уровня в качестве указателя на параметры функции и локальные переменные, размещенные в стеке;
* ESI (индекс источника) используется в качестве указателя операнда-источника в строковых командах;
* EDI (индекс назначения) адресует операнд-приемник. Регистры ESI и EDI обычно используют для команд пересылки данных из одного участка памяти в другой.

Регистры EAX, EBX, ECX, EDX можно использовать как 16-разрядные регистры, или же как два 8-разрядных регистра — например, регистр EAX можно использовать как 16-разрядный регистр AX; регистр AX можно использовать как два 8-разрядных регистра AH и AL. В регистре AX содержится младшее слово регистра EAX, в AH и AL — старший и младший байт слова из AX.

К регистрам ESP, EBP, ESI, EDI можно обращаться как к 16-разрядным регистрам SP, BP, SI, DI. 

## Специализированные регистры

### Сегментные регистры

Сегментные регистры содержат адреса начала сегментов. 

* Регистр CS содержит стартовый адрес сегмента кода — в этом сегменте содержатся инструкции программы;
* Регистр DS содержит стартовый адрес сегмента данных — в этом сегменте находятся данные программы;
* Регистр SS содержит стартовый адрес сегмента стека;
* Регистры ES, FS, GS содержат стартовые адреса дополнительных сегментов данных.

### Регистр флагов

Реrистр флагов EFLAGS характеризует состояние микропроцессора и управляет ero настройками.

* CF (Carry Flag) — флаг переноса содержит значение переноса после операции сложения или заёма после операции вычитания. Также устанавливается, если при выполнении беззнакового сложения происходит переполнение (разрядность результата больше разрядности выделенного для него поля);
* PF (Parity Flag) — флаг паритета устанавливается, если младший байт результата операции содержит четное число единичных бит;
* AF (Auxiliary Carry Flag) — флаг промежуточного переноса содержит значение межтетрадного переноса при сложении и заема при вычитании;
* ZF (Zero Flag) — флаг нуля устанавливается, если результат операции равен нулю;
* SF (Sign Flag) — флаг знака содержит копию старшего (знакового) бита результата операции;
* TF (Trap Flag) — флаг ловушки обеспечивает аппаратную поддержку пошаговой отладки, после каждой инструкции происходит прерывание специального типа;
* IF (Interrupt Flag) — флаг прерываний разрешает проверку внешнего запроса на прерывание по каналу INTR (Interrupt Request).
* DF (Direction Flag) — флаг направления определяет режим автоматического изменения регистров DI/SI при выполнении строковых инструкций; 
* OF (Overflow Flag) — флаг переполнения устанавливается, если происходит переполнение при сложении знаковых чисел.

Перечисленные выше флаги существуют в процессорах 8086/8088/80186/80188. Далее будут перечислены флаги, содержащиеся в процессоре 80386:

* IOPL (I/O Privelege Level) — уровень привелегий ввода-вывода используется в защищенном режиме, где определяется уровень привелегий ввода-вывода текущей задачи. Для него выделяется 2 бита, 00 - наивысшие привилегии.

* NT (Nested Task) — флаг вложенной задачи установлен в 1, если текущая задача является вложенной по отношению к другой задаче;

* RF (Resume Flag) — флаг возобновления используется при отладке для возобновления программы после выполнения следующей инструкции;

* VM (Virtual Mode) — флаг режима виртуальной машины 8086 в рамках защищенного режима.

### Указатель инструкции

В регистре указателя инструкции EIP хранится адрес следующей выполняемой команды. Этот адрес изменяется при последовательном выполнении команд, а также при использовании команд перехода. 
Регистр EIP не может быть доступен напрямую с помощью программного обеспечения; он неявно контролируется инструкциями передачи управления (например, JMP, Jcc, CALL и RET), прерываниями и исключениями. 
Из-за предварительной выборки команд адрес команды, считанный из шины во время загрузки команды, не совпадает со значением в регистре EIP.

&nbsp;
<hr>

> [Список вопросов](Вопросы_ТПП.md)

&nbsp;
<hr>

> [Список вопросов](Вопросы_ТПП.md)